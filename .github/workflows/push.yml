name: Push to Replicate

on:
  workflow_dispatch:
    inputs:
      model_name:
        description: 'erayyavuz/interior-ai'
        required: true

jobs:
  push_to_replicate:
    name: Push to Replicate
    runs-on: ubuntu-latest
    steps:
      # 1. Repository'i Klonla
      - name: Repository'i Klonla
        uses: actions/checkout@v4

      # 2. Cog'u Yükle
      - name: Cog'u Yükle
        run: |
          sudo curl -L https://github.com/replicate/cog/releases/download/v0.9.23/cog_Linux_x86_64 -o /usr/local/bin/cog
          sudo chmod +x /usr/local/bin/cog
          cog --version

      # 3. Replicate’a Push Etme
      - name: Replicate’a Push Et
        run: cog push r8.im/${{ inputs.model_name }}
        env:
        env:
          HUGGINGFACE_TOKEN: ${{ secrets.HUGGINGFACE_TOKEN }}
          REPLICATE_API_TOKEN: ${{ secrets.REPLICATE_API_TOKEN }}

      # 4. Hata Ayıklama (Opsiyonel)
      - name: Ek Hata Ayıklama
        if: failure()
        run: |
          echo "PATH: $PATH"
          which cog
          cog --version
